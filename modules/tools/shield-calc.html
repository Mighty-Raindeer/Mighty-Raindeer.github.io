<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Radiation Shielding Calculator</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <style>
        :root {
            --bg-primary: #1a1a1a;
            --bg-secondary: #242424;
            --bg-card: #2d2d2d;
            --text-primary: #e0e0e0;
            --text-secondary: #b0b0b0;
            --accent-primary: #ff5722;
            --accent-hover: #f4511e;
            --border-color: rgba(255, 255, 255, 0.1);
            --highlight-color: rgba(255, 87, 34, 0.2);
        }

        body {
            margin: 0;
            padding: 20px;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            font-family: 'Montserrat', sans-serif;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 400px 1fr;
            gap: 20px;
        }

        .calculator-section, .visualization-section {
            background: var(--bg-secondary);
            padding: 20px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        h1 {
            color: var(--accent-primary);
            margin-top: 0;
            text-align: center;
            grid-column: 1 / -1;
        }

        h2 {
            color: var(--accent-primary);
            margin-top: 0;
            font-size: 1.3em;
        }

        h3 {
            color: var(--accent-primary);
            font-size: 1.1em;
            margin-top: 20px;
        }

        .control-panel {
            background: var(--bg-card);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            margin-bottom: 15px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            color: var(--text-primary);
            font-size: 0.9em;
        }

        select, input {
            width: 100%;
            padding: 10px;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            border-radius: 4px;
            font-size: 0.95em;
            box-sizing: border-box;
        }

        select:focus, input:focus {
            outline: none;
            border-color: var(--accent-primary);
        }

        .results {
            background: var(--bg-card);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
        }

        .result-item {
            margin: 8px 0;
            padding: 8px;
            background: var(--bg-primary);
            border-radius: 4px;
        }

        .result-label {
            color: var(--text-secondary);
            font-size: 0.85em;
        }

        .result-value {
            color: var(--accent-primary);
            font-weight: bold;
            font-size: 1.1em;
        }

        .diagram-container {
            width: 100%;
            height: 350px;
            background: var(--bg-card);
            border-radius: 8px;
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
        }

        .chart-container {
            width: 100%;
            height: 500px;
            background: var(--bg-card);
            border-radius: 8px;
            padding: 15px;
            box-sizing: border-box;
        }

        .info-box {
            background: var(--bg-card);
            padding: 12px;
            border-radius: 8px;
            border-left: 3px solid var(--accent-primary);
            margin-bottom: 15px;
            font-size: 0.9em;
        }

        .equation-display {
            background: var(--bg-card);
            padding: 15px;
            border-radius: 8px;
            font-family: 'Times New Roman', serif;
            font-size: 0.95em;
            margin-bottom: 15px;
        }

        .equation-display ul {
            list-style: none;
            padding-left: 0;
            margin: 10px 0;
        }

        .equation-display li {
            margin: 5px 0;
            padding-left: 10px;
        }

        @media (max-width: 1200px) {
            .container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 style="grid-column: 1 / -1;">Radiation Shielding Calculator</h1>

        <div class="calculator-section">
            <h2>Shielding Parameters</h2>

            <div class="control-panel">
                <div class="form-group">
                    <label for="source-type">Radiation Source:</label>
                    <select id="source-type">
                        <option value="ir192">Ir-192 (Brachytherapy, ~0.38 MeV)</option>
                        <option value="co60">Co-60 (Teletherapy, 1.17-1.33 MeV)</option>
                        <option value="6mv" selected>6 MV Photon (Linear Accelerator)</option>
                        <option value="15mv">15 MV Photon (Linear Accelerator)</option>
                        <option value="proton">Proton Beam (150 MeV)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="wall-material">Shielding Material:</label>
                    <select id="wall-material">
                        <option value="concrete" selected>Concrete (ρ = 2.35 g/cm³)</option>
                        <option value="borated-concrete">Borated Concrete (ρ = 2.5 g/cm³)</option>
                        <option value="steel">Steel (ρ = 7.87 g/cm³)</option>
                        <option value="lead">Lead (ρ = 11.4 g/cm³)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="distance">Distance to Barrier (m):</label>
                    <input type="number" id="distance" min="0.5" max="20" step="0.1" value="3.0">
                </div>

                <div class="form-group">
                    <label for="wall-thickness">Barrier Thickness (cm):</label>
                    <input type="number" id="wall-thickness" min="0" max="500" step="0.5" value="30">
                </div>

                <div class="form-group">
                    <label for="initial-dose">Initial Dose Rate at 1m (mSv/hr):</label>
                    <input type="number" id="initial-dose" min="1" max="100000" step="1" value="1000">
                </div>
            </div>

            <div class="equation-display">
                <h3>Shielding Equation:</h3>
                <p><strong>I = I₀ × (d₀/d)² × e^(-μx) × 10^(-x/TVL)</strong></p>
                <p style="font-size: 0.85em; margin-top: 10px;">Where:</p>
                <ul style="font-size: 0.85em;">
                    <li><strong>I</strong> = Transmitted intensity</li>
                    <li><strong>I₀</strong> = Initial dose rate at 1m</li>
                    <li><strong>d₀</strong> = Reference distance (1m)</li>
                    <li><strong>d</strong> = Distance from source</li>
                    <li><strong>μ</strong> = Linear attenuation coefficient</li>
                    <li><strong>x</strong> = Shield thickness</li>
                    <li><strong>TVL</strong> = Tenth Value Layer</li>
                </ul>
            </div>

            <div class="info-box">
                <strong>Reference Standards:</strong><br>
                • NCRP Report 151 (Megavoltage)<br>
                • NCRP Report 147 (Brachytherapy)<br>
                • AAPM Task Group Reports
            </div>

            <div class="results">
                <h3>Calculation Results</h3>
                <div class="result-item">
                    <div class="result-label">Dose Before Barrier:</div>
                    <div class="result-value" id="dose-before">---</div>
                </div>
                <div class="result-item">
                    <div class="result-label">Transmission Factor:</div>
                    <div class="result-value" id="transmission">---</div>
                </div>
                <div class="result-item">
                    <div class="result-label">Dose After Barrier:</div>
                    <div class="result-value" id="dose-after">---</div>
                </div>
                <div class="result-item">
                    <div class="result-label">Attenuation (TVLs):</div>
                    <div class="result-value" id="tvl-count">---</div>
                </div>
                <div class="result-item">
                    <div class="result-label">Material TVL:</div>
                    <div class="result-value" id="tvl-value">---</div>
                </div>
            </div>
        </div>

        <div class="visualization-section">
            <h2>Side View Diagram</h2>
            <div class="diagram-container">
                <svg width="100%" height="100%" viewBox="0 0 800 350" preserveAspectRatio="xMidYMid meet">
                    <!-- Ground reference line -->
                    <line x1="0" y1="300" x2="800" y2="300" stroke="rgba(255,255,255,0.2)" stroke-width="1" stroke-dasharray="5,5"/>

                    <!-- Source (radiation symbol) -->
                    <g id="source">
                        <circle cx="100" cy="175" r="25" fill="none" stroke="#FFD700" stroke-width="3"/>
                        <circle cx="100" cy="175" r="15" fill="none" stroke="#FFD700" stroke-width="2"/>
                        <circle cx="100" cy="175" r="5" fill="#FFD700"/>
                        <!-- Radiation rays -->
                        <line x1="100" y1="175" x2="120" y2="155" stroke="#FFD700" stroke-width="2"/>
                        <line x1="100" y1="175" x2="120" y2="195" stroke="#FFD700" stroke-width="2"/>
                        <line x1="100" y1="175" x2="125" y2="175" stroke="#FFD700" stroke-width="2"/>
                    </g>

                    <!-- Distance indicator -->
                    <g id="distance-indicator">
                        <line x1="130" y1="320" x2="450" y2="320" stroke="var(--accent-primary)" stroke-width="2"/>
                        <line x1="130" y1="315" x2="130" y2="325" stroke="var(--accent-primary)" stroke-width="2"/>
                        <line x1="450" y1="315" x2="450" y2="325" stroke="var(--accent-primary)" stroke-width="2"/>
                        <text id="distance-label" x="290" y="340" text-anchor="middle" fill="var(--accent-primary)" font-size="14">3.0 m</text>
                    </g>

                    <!-- Barrier/Wall -->
                    <g id="barrier">
                        <rect x="450" y="50" width="60" height="250" fill="rgba(100, 100, 100, 0.8)" stroke="white" stroke-width="2"/>
                        <text id="thickness-label" x="480" y="35" text-anchor="middle" fill="white" font-size="12">30 cm</text>
                        <!-- Hatching pattern for material -->
                        <pattern id="material-pattern" patternUnits="userSpaceOnUse" width="10" height="10">
                            <line x1="0" y1="0" x2="10" y2="10" stroke="rgba(255,255,255,0.3)" stroke-width="1"/>
                        </pattern>
                        <rect x="450" y="50" width="60" height="250" fill="url(#material-pattern)"/>
                    </g>

                    <!-- Measurement point -->
                    <g id="measurement-point">
                        <circle cx="700" cy="175" r="12" fill="var(--accent-primary)" stroke="white" stroke-width="2"/>
                        <text x="700" y="210" text-anchor="middle" fill="white" font-size="14">Measurement</text>
                        <text x="700" y="225" text-anchor="middle" fill="white" font-size="14">Point</text>
                    </g>

                    <!-- Radiation beam -->
                    <defs>
                        <linearGradient id="beam-gradient" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" style="stop-color:#FFD700;stop-opacity:0.6" />
                            <stop offset="50%" style="stop-color:#FFD700;stop-opacity:0.3" />
                            <stop offset="100%" style="stop-color:#FFD700;stop-opacity:0.1" />
                        </linearGradient>
                    </defs>
                    <polygon points="125,160 125,190 450,180 450,170" fill="url(#beam-gradient)" opacity="0.7"/>
                    <polygon points="510,172 510,178 700,176 700,174" fill="url(#beam-gradient)" opacity="0.3"/>

                    <!-- Labels -->
                    <text x="100" y="230" text-anchor="middle" fill="#FFD700" font-size="14" font-weight="bold">Source</text>
                    <text x="480" y="180" text-anchor="middle" fill="white" font-size="12" id="material-label">Concrete</text>
                </svg>
            </div>

            <h2>Exponential Attenuation Curve</h2>
            <div class="chart-container">
                <canvas id="attenuationChart"></canvas>
            </div>
        </div>
    </div>

    <script>
        // Shielding data based on NCRP 151, NCRP 147, and AAPM reports
        const shieldingData = {
            ir192: {
                name: 'Ir-192',
                energy: '0.38 MeV',
                tvl: {
                    concrete: 11.0,    // cm - NCRP 147
                    'borated-concrete': 10.0,
                    steel: 4.0,        // cm - calculated from HVL
                    lead: 0.6          // cm - NCRP 147
                }
            },
            co60: {
                name: 'Co-60',
                energy: '1.17-1.33 MeV',
                tvl: {
                    concrete: 21.0,    // cm - NCRP 147
                    'borated-concrete': 19.5,
                    steel: 7.0,        // cm
                    lead: 4.5          // cm - from literature
                }
            },
            '6mv': {
                name: '6 MV Photon',
                energy: '6 MV',
                tvl: {
                    concrete: 35.0,    // cm - NCRP 151 primary barrier
                    'borated-concrete': 34.0,
                    steel: 9.9,        // cm - NCRP 151
                    lead: 5.7          // cm - NCRP 151
                }
            },
            '15mv': {
                name: '15 MV Photon',
                energy: '15 MV',
                tvl: {
                    concrete: 44.0,    // cm - NCRP 151 (interpolated)
                    'borated-concrete': 42.0,
                    steel: 11.0,       // cm - NCRP 151
                    lead: 5.7          // cm - NCRP 151 (constant for MV)
                }
            },
            proton: {
                name: 'Proton',
                energy: '150 MeV',
                tvl: {
                    concrete: 48.0,    // cm - effective TVL based on literature
                    'borated-concrete': 45.0,  // Better for neutrons
                    steel: 12.0,       // cm
                    lead: 6.5          // cm
                }
            }
        };

        let attenuationChart = null;

        function getTVL(sourceType, material) {
            return shieldingData[sourceType].tvl[material];
        }

        function calculateAttenuation(I0, distance, thickness, tvl) {
            // Inverse square law
            const distanceFactor = 1 / (distance * distance);
            const doseAtBarrier = I0 * distanceFactor;

            // Exponential attenuation through barrier
            const numTVLs = thickness / tvl;
            const transmissionFactor = Math.pow(10, -numTVLs);
            const doseAfterBarrier = doseAtBarrier * transmissionFactor;

            return {
                doseAtBarrier: doseAtBarrier,
                transmissionFactor: transmissionFactor,
                doseAfterBarrier: doseAfterBarrier,
                numTVLs: numTVLs
            };
        }

        function updateCalculations() {
            const sourceType = document.getElementById('source-type').value;
            const material = document.getElementById('wall-material').value;
            const distance = parseFloat(document.getElementById('distance').value);
            const thickness = parseFloat(document.getElementById('wall-thickness').value);
            const I0 = parseFloat(document.getElementById('initial-dose').value);

            const tvl = getTVL(sourceType, material);
            const results = calculateAttenuation(I0, distance, thickness, tvl);

            // Update results display
            document.getElementById('dose-before').textContent =
                results.doseAtBarrier.toExponential(3) + ' mSv/hr';
            document.getElementById('transmission').textContent =
                results.transmissionFactor.toExponential(3);
            document.getElementById('dose-after').textContent =
                results.doseAfterBarrier.toExponential(3) + ' mSv/hr';
            document.getElementById('tvl-count').textContent =
                results.numTVLs.toFixed(2) + ' TVLs';
            document.getElementById('tvl-value').textContent =
                tvl.toFixed(2) + ' cm';

            // Update diagram labels
            document.getElementById('distance-label').textContent = distance.toFixed(1) + ' m';
            document.getElementById('thickness-label').textContent = thickness.toFixed(1) + ' cm';

            const materialNames = {
                'concrete': 'Concrete',
                'borated-concrete': 'Borated Concrete',
                'steel': 'Steel',
                'lead': 'Lead'
            };
            document.getElementById('material-label').textContent = materialNames[material];

            // Update barrier width in SVG (scale appropriately)
            const barrierWidth = Math.min(120, Math.max(20, thickness * 1.5));
            const barrier = document.querySelector('#barrier rect');
            barrier.setAttribute('width', barrierWidth);

            // Update distance indicator
            const distanceX = 130 + (distance / 10) * 320;  // Scale distance
            document.querySelector('#distance-indicator line').setAttribute('x2', distanceX);
            document.querySelector('#distance-indicator line:nth-child(3)').setAttribute('x1', distanceX);
            document.querySelector('#distance-indicator line:nth-child(3)').setAttribute('x2', distanceX);
            document.querySelector('#distance-label').setAttribute('x', (130 + distanceX) / 2);

            // Update barrier position
            const barrierX = distanceX;
            document.querySelectorAll('#barrier rect, #barrier rect + rect').forEach(rect => {
                rect.setAttribute('x', barrierX);
            });
            document.getElementById('thickness-label').setAttribute('x', barrierX + barrierWidth/2);

            // Update beam
            const beamPoly1 = document.querySelector('polygon:first-of-type');
            beamPoly1.setAttribute('points', `125,160 125,190 ${barrierX},180 ${barrierX},170`);
            const beamPoly2 = document.querySelector('polygon:last-of-type');
            beamPoly2.setAttribute('points', `${barrierX + barrierWidth},172 ${barrierX + barrierWidth},178 700,176 700,174`);

            // Update chart
            updateChart(I0, distance, thickness, tvl);
        }

        function updateChart(I0, distance, thickness, tvl) {
            const ctx = document.getElementById('attenuationChart').getContext('2d');

            // Generate data points
            const dataPoints = [];
            const totalDistance = distance + (thickness / 100); // Convert cm to m
            const steps = 200;

            for (let i = 0; i <= steps; i++) {
                const x = (totalDistance / steps) * i;
                let intensity;

                if (x < distance) {
                    // Before barrier - only inverse square law
                    const d = x === 0 ? 1 : x;
                    intensity = I0 / (d * d);
                } else {
                    // At and after barrier - inverse square + attenuation
                    const doseAtBarrier = I0 / (distance * distance);
                    const thicknessTraversed = (x - distance) * 100; // m to cm
                    const numTVLs = thicknessTraversed / tvl;
                    const transmissionFactor = Math.pow(10, -numTVLs);
                    intensity = doseAtBarrier * transmissionFactor;
                }

                dataPoints.push({x: x, y: intensity});
            }

            // Create or update chart
            if (attenuationChart) {
                attenuationChart.destroy();
            }

            attenuationChart = new Chart(ctx, {
                type: 'line',
                data: {
                    datasets: [{
                        label: 'Dose Rate (mSv/hr)',
                        data: dataPoints,
                        borderColor: '#ff5722',
                        backgroundColor: 'rgba(255, 87, 34, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.1,
                        pointRadius: 0
                    }, {
                        label: 'Barrier Location',
                        data: [
                            {x: distance, y: 0},
                            {x: distance, y: I0}
                        ],
                        borderColor: 'rgba(255, 255, 255, 0.5)',
                        borderWidth: 2,
                        borderDash: [5, 5],
                        pointRadius: 0,
                        fill: false
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            type: 'linear',
                            title: {
                                display: true,
                                text: 'Distance from Source (m)',
                                color: '#e0e0e0'
                            },
                            ticks: {
                                color: '#b0b0b0'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        },
                        y: {
                            type: 'logarithmic',
                            title: {
                                display: true,
                                text: 'Dose Rate (mSv/hr) - Log Scale',
                                color: '#e0e0e0'
                            },
                            ticks: {
                                color: '#b0b0b0',
                                callback: function(value) {
                                    return value.toExponential(0);
                                }
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: '#e0e0e0'
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    if (context.datasetIndex === 0) {
                                        return 'Dose Rate: ' + context.parsed.y.toExponential(3) + ' mSv/hr';
                                    }
                                    return context.dataset.label;
                                }
                            }
                        }
                    }
                }
            });
        }

        // Event listeners
        ['source-type', 'wall-material', 'distance', 'wall-thickness', 'initial-dose'].forEach(id => {
            document.getElementById(id).addEventListener('input', updateCalculations);
        });

        // Initial calculation
        updateCalculations();
    </script>

    <footer class="disclaimer-footer">
        <div class="disclaimer-content">
            <p class="disclaimer-text">
                <span class="disclaimer-icon">⚠️</span>
                <strong>Educational Purpose Only:</strong>
                This tool is designed for educational and training purposes only based on NCRP Reports 151, 147, and AAPM guidelines.
                It should not be used for actual shielding design or regulatory compliance.
                Always consult qualified radiation safety personnel and use appropriate detailed methodologies for real shielding design.
            </p>
            <p class="disclaimer-version">
                Last Updated: February 2026 | Version 2.0 | Based on NCRP 151, NCRP 147, AAPM Standards
            </p>
        </div>
    </footer>

    <style>
        .disclaimer-footer {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--bg-secondary);
            border-top: 1px solid var(--border-color);
            padding: 10px 20px;
            z-index: 1000;
        }

        .disclaimer-content {
            max-width: 1400px;
            margin: 0 auto;
            font-size: 0.85rem;
            color: var(--text-secondary);
            text-align: center;
        }

        .disclaimer-text {
            margin: 5px 0;
            line-height: 1.4;
        }

        .disclaimer-icon {
            font-size: 1.2em;
            margin-right: 8px;
            vertical-align: middle;
        }

        .disclaimer-version {
            font-size: 0.75rem;
            margin-top: 5px;
            opacity: 0.7;
        }

        .container {
            margin-bottom: 120px;
        }

        @media (max-width: 1200px) {
            .disclaimer-footer {
                padding: 8px 12px;
            }

            .disclaimer-content {
                font-size: 0.8rem;
            }

            .disclaimer-version {
                font-size: 0.7rem;
            }
        }
    </style>
</body>
</html>
